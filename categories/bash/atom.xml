<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: bash | > kodama.gr_]]></title>
  <link href="http://www.kodama.gr/categories/bash/atom.xml" rel="self"/>
  <link href="http://www.kodama.gr/"/>
  <updated>2013-11-04T21:06:03+02:00</updated>
  <id>http://www.kodama.gr/</id>
  <author>
    <name><![CDATA[Tasos Latsas]]></name>
    <email><![CDATA[tlatsas@gmx.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[generate jekyll front-matter with bash]]></title>
    <link href="http://www.kodama.gr/2011/08/31/generate-jekyll-front-matter-with-bash/"/>
    <updated>2011-08-31T23:35:11+03:00</updated>
    <id>http://www.kodama.gr/2011/08/31/generate-jekyll-front-matter-with-bash</id>
    <content type="html"><![CDATA[<p>Creating a post in a jekyll-powered blog is pretty straightforward. Just create a file in markdown format and put your post in.
Every post has a special <a href="https://github.com/mojombo/jekyll/wiki/YAML-Front-Matter">YAML Front Matter</a> block with some variables.
Using a bash script we can easily generate this file with proper values for the YAML variables.
For example, for this post, the filename contains the post date and title.</p>

<p><div class="highlight"><pre><code class="text">2011-08-31-generate-jekyll-front-matter-with-bash.markdown
</code></pre></div></p>

<p>The same values (date, title) are contained in the YAML block inside the file, but a bit more formatted.
A Bash script can take care the formatting for us by only supplying the post title as the script argument.
This assumes that the date (and optionally time) are set to the current time we run the bash script.</p>

<p>First we need to grab the date and optionaly the time.</p>

<p><div class="highlight"><pre><code class="bash"><span class="nv">_date</span><span class="o">=</span><span class="k">$(</span>date +’%Y-%m-%d’<span class="k">)</span>
<span class="nv">_datetime</span><span class="o">=</span><span class="k">$(</span>date +’%Y-%m-%d %H:%M:%S’<span class="k">)</span>
</code></pre></div></p>

<p><strong>_date</strong> will be used for the filename and <strong>_datetime</strong> for the <em>date</em> variable.</p>

<p>We also need to replace whitespace with dashes in the post title, for use in the filename.</p>

<p><div class="highlight"><pre><code class="bash"><span class="nv">_post</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$1</span> | tr ‘ ‘ ‘-‘<span class="k">)</span>
</code></pre></div></p>

<p>The filename is supplied a an argument, so we might want to bail if the user does not supply one</p>

<p><div class="highlight"><pre><code class="bash"><span class="k">if</span> <span class="o">[[</span> -z <span class="nv">$1</span> <span class="o">]]</span>; <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> “A post title is required. Bye..”
    <span class="nb">exit </span>1
<span class="k">fi</span>
</code></pre></div></p>

<p>Also, another safe switch would be to check if the file already exists to prevent accidental overwrites.</p>

<p>To do that we need the absolute path for our post file. Putting all these together we have:</p>

<p><div class="highlight"><pre><code class="bash"><span class="nv">_title</span><span class="o">=</span>”<span class="k">${</span><span class="nv">_date</span><span class="k">}</span>-<span class="k">${</span><span class="nv">_post</span><span class="k">}</span>.markdown”
<span class="nv">_cwd</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
<span class="nv">_post_file</span><span class="o">=</span>”<span class="k">${</span><span class="nv">_cwd</span><span class="k">}</span>/<span class="k">${</span><span class="nv">_title</span><span class="k">}</span>”&lt;/p&gt;

&lt;p&gt;if <span class="o">[[</span> -f <span class="k">${</span><span class="nv">_post_file</span><span class="k">}</span> <span class="o">]]</span>; <span class="k">then</span>
<span class="k">    </span><span class="nb">echo</span> “File already exists. Bye..”
    <span class="nb">exit </span>1
<span class="k">fi</span>
</code></pre></div></p>

<p>Finally, the magic code that creates our post file uses <a href="http://tldp.org/LDP/abs/html/here-docs.html">here documents</a></p>

<p><div class="highlight"><pre><code class="bash">cat « EOF &amp;gt;| <span class="k">${</span><span class="nv">_post_file</span><span class="k">}</span>
—
layout: post
title: <span class="nv">$1</span>
date: <span class="nv">$_datetime</span>
—
EOF
</code></pre></div></p>

<p>Make sure to avoid quoting of the <strong>EOF</strong> as bash variable subsitution won’t work.
Also, note that I used the &gt;| notation because I have the bash <a href="http://www.cyberciti.biz/tips/howto-keep-file-safe-from-overwriting.html">noclobber</a> variable set.</p>

<p>The <a href="https://github.com/tlatsas/utils-scripts/blob/master/jekyll-post">jekyll-post script</a> is on github, also added some code to prompt user for launching a text editor.</p>
]]></content>
  </entry>
  
</feed>
