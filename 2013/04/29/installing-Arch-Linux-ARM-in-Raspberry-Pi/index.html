

<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>installing Arch Linux ARM in Raspberry Pi - > kodama.gr_</title>
    <meta name="author" content="Tasos Latsas">
    
    <meta name="description" content="installing Arch Linux ARM in Raspberry Pi Apr 29th, 2013 archlinux rpi This tutorial guides you through the process of installing the ARM flavour of &hellip;">
    
    <meta name="viewport" content="width=device-width">
    
    <link rel="canonical" href="http://www.kodama.gr/2013/04/29/installing-Arch-Linux-ARM-in-Raspberry-Pi">
    <link href="/favicon.png" rel="icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="//atom.xml" rel="alternate" title="> kodama.gr_" type="application/atom+xml">
  </head>


  <body >

    <header>
      <div class="grid-wrapper">
  <div class="grid">

    <div class="grid__item two-fifths lap-four-sixths palm-one-whole">
  <a href="/" class="site-title">> kodama.gr_</a>
</div>

<div class="grid__item three-fifths lap-two-sixths palm-one-whole">
  <nav>
    <input type="checkbox" id="toggle">
<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
<ul class="menu pull-right">
  <li><a href="/">blog</a></li>
  <li><a href="/archives/">archives</a></li>
  <li><a href="/categories/">categories</a></li>
  <li><a href="/projects/">projects</a></li>
  <li><a href="/about/">about</a></li>
</ul>

  </nav>
</div>

  </div>
</div>
    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

          <article class="post">
  <header>
  
  <h1 class="title indent">installing Arch Linux ARM in Raspberry Pi</h1>
  

  
  <div class="meta clearfix">
    








  


<time class="pull-left" datetime="2013-04-29T16:44:38+03:00" pubdate data-updated="true"><i class="icon-calendar"></i> Apr 29<span>th</span>, 2013</time>
    



  
  <div class="pull-left">
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      <li><a href="/categories/archlinux/">archlinux</a></li>
    
      <li><a href="/categories/rpi/">rpi</a></li>
    
    </ul>
  </div>
  

    
  </div>
  
</header>




  <p>This tutorial guides you through the process of installing the ARM flavour of
Arch Linux in a RaspberryPi. This is a headless installation procedure,
no monitor/tv or keyboard are required.</p>

<h3 id="get-arch-linux-arm">Get Arch Linux ARM</h3>

<p>You can download the image using a direct download link or torrent. The latest version
available (at this time) is the <code>archlinux-hf-2013-02-11</code>. After downloading the zip archive containing the
image verify the SHA-1 checksum. First download the <code>archlinux-hf-2013-02-11.zip.sha1</code> file
in the same path as the zip archive and then run:</p>

<div class="highlight"><pre><code class="text">$ sha1sum -c archlinux-hf-2012-09-18.img.sha1
</code></pre></div>

<h3 id="install-on-sd-card">Install on SD card</h3>

<p>The installation process is pretty straighforward. Insert the SD card in your computer
and transfer the image to the card using the <code>dd</code> command as root. As always, pay attention
to the supplied destination device. Make sure you use the one corresponding to the SD card
or you could trash all your data on other devices. Also make sure that the destination device
is not mounted. You can use the <code>lsblk</code> command to verity that. We will just use <code>sdX</code> as an example.</p>

<div class="highlight"><pre><code class="text"># dd bs=1M if=archlinux-hf-2013-02-11.img of=/dev/sdX
</code></pre></div>

<h3 id="expanding-the-root-partition">Expanding the root partition</h3>

<p>After the image transfer is complete two partitions are created. The <code>sdX1</code> partition will be mounted
at <code>/boot</code> and the filesystem is <code>VFAT</code>. The other partition, <code>sdX2</code> holds the root filesystem and is
formatted as <code>ext4</code>.</p>

<p>The root filesystem is a little smaller than 2GB. If the SD card is bigger (it should be) we need to expand
this partition to fill the remaining space. Alternatively we could create a second filesystem and mounted at
a mount point of our choice. The creation of a new filesystem is really simple, so it is not covered here.</p>

<p>In order to utilize the remaining free space, first we expand the partition and then we expand the filesystem.
As always make sure that the partitions are not mounted and that you are altering the proper ones. The following
examples assume that the SD card is the device <code>/dev/sdb</code> and the root partition the <code>/dev/sdb2</code>.</p>

<p>Start <code>fdisk</code>. The <code>p</code> command lists the partitions in the device <code>/dev/sdb</code>.</p>

<div class="highlight"><pre><code class="text"># fdisk -u=sectors /dev/sdb
   Command: p

   Disk /dev/sdb: 7822 MB, 7822376960 bytes
   241 heads, 62 sectors/track, 1022 cylinders, total 15278080 sectors
   Units = sectors of 1 * 512 = 512 bytes
   Sector size (logical/physical): 512 bytes / 512 bytes
   I/O size (minimum/optimal): 512 bytes / 512 bytes
   Disk identifier: 0x000c21e5

   Device Boot      Start         End      Blocks   Id  System
   /dev/sdb1   *        2048      194559       96256    c  W95 FAT32 (LBA)
   /dev/sdb2          194560     3862527     1833984   83  Linux
</code></pre></div>

<p>Then, we delete the the second partition (the roor):</p>

<div class="highlight"><pre><code class="text">Command (m for help): d 
Partition number (1-4): 2
Partition 2 is deleted
</code></pre></div>

<p>and re-create it. We create the new partition as primary and we set the last sector at the end of the SD card.
The default settings should be fine here.</p>

<div class="highlight"><pre><code class="text">Command (m for help): n
Partition type:
   p   primary (1 primary, 0 extended, 3 free)
   e   extended
Select (default p): p
Partition number (1-4, default 2): 2
First sector (186368-15278079, default 186368): 
Using default value 186368
Last sector, +sectors or +size{K,M,G} (186368-15278079, default 15278079): 
Using default value 15278079
Partition 2 of type Linux and of size 7.2 GiB is set
</code></pre></div>

<p>The partition is already set to Linux (83) so there is no need to alter it. Finally, save the changes:</p>

<div class="highlight"><pre><code class="text">Command (m for help): w
The partition table has been altered!

Calling ioctl() to re-read partition table.
Syncing disks.
</code></pre></div>

<p>In order to expand the filesystem, first we run the checkdisk program to detect and fix inconsistencies and
then use the resize program.</p>

<div class="highlight"><pre><code class="text"># e2fsck -f /dev/sdb2
# resize2fs /dev/sdb2
</code></pre></div>

<h3 id="ip-discovery-and-remote-login">IP discovery and remote login</h3>

<p>The Arch Linux ARM image has the ssh deamon enabled by default. In order to login we must first
determine which IP the rpi has acquired from the local network. This assumes that there is a
working DHCP server on the LAN. One way to get the IP address is to check the DHCP logs or the router
logs if DHCP is running from a router. As an alternative, we can run a ping scan on the LAN using
nmap. Assuming that the lan subnet is 192.168.0.0 with mask 255.255.255.0 run:</p>

<div class="highlight"><pre><code class="text"># nmap -PE -sn -n 192.168.0.0/24
</code></pre></div>

<p>After finding the IP login using the username and password <code>root</code>.</p>

<h3 id="post-install-configuration">Post-install configuration</h3>

<p>After you login, you should change the root password using <code>passwd</code>. Also, it is a good idea to re-generate
the rsa and dsa keys.</p>

<div class="highlight"><pre><code class="text"># ssh-keygen -f /etc/ssh/ssh_host_dsa_key -N &quot;&quot; -t dsa
# ssh-keygen -f /etc/ssh/ssh_host_rsa_key -N &quot;&quot; -t rsa
</code></pre></div>

<p>Answer “yes” on prompt to overwrite. To run a full system upgrade run:</p>

<div class="highlight"><pre><code class="text"># pacman -Syu
</code></pre></div>

<h3 id="memory-allocation">Memory allocation</h3>

<p>Depending on the usage you are planning to do with the rpi it might be a good idea to adjust the RAM
split between the CPU and the GPU. Edit the file <code>/boot/config.txt</code> file and change the value of the
variable <code>gpu_mem_256</code> or <code>gpu_mem_521</code> depending on the rpi model you have.
<a href="http://raspberrypi.stackexchange.com/a/1675">This post</a> shows the valid memory values. Note that you
must also take into consideration the <code>cma_lwm</code> and <code>cma_hwm</code> variables. These variables allow dynamic
memory management at runtime. Make sure that <code>gpu_mem_256</code> (or 512) value is higher than the high water mark
<code>cma_hwm</code>. More info at the links on the bottom of this post.</p>

<h3 id="sources-and-further-reading">Sources and further reading</h3>

<ul>
  <li><a href="http://raspberrypi.stackexchange.com/a/1675">memory allocation</a></li>
  <li><a href="http://litwol.com/content/fdisk-resizegrow-physical-partition-without-losing-data-linodecom">resize physical parition</a></li>
  <li><a href="http://www.raspberrypi.org/phpBB3/viewtopic.php?f=29&amp;t=19334&amp;p=218282&amp;hilit=cma#p217665">dynamic memory split</a></li>
  <li><a href="http://elinux.org/RPi_config.txt#Memory">rpi memory configuration</a></li>
  <li><a href="http://archlinuxarm.org/platforms/armv6/raspberry-pi">Arch Linux ARM for RPI</a></li>
  <li><a href="https://wiki.archlinux.org/index.php/Beginners%27_Guide#Post-installation">Arch Linux post-installation notes</a></li>
</ul>


</article>

 
<section id="disqus">
  <h1 class="indent title">Comments</h1>
  <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

        
        </div>
        
        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">

  
<section class="social aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">
    Follow me!
  </h1>
  <ul class="unstyled">
    
    
    <li><a class="github" href="//github.com/tlatsas"><i class="icon-github"></i> Github</a></li>
    
    <li><a class="gplus" href="//plus.google.com/113297710160205489384"><i class="icon-google-plus-sign"></i> Google+</a></li>
    <li><a class="linkedin" href="//linkedin.com/in/tasoslatsas"><i class="icon-linkedin-sign"></i> LinkedIn</a></li>
    
    <li><a class="stackoverflow" href="//stackoverflow.com/users/1208521"><i class="icon-stackexchange"></i> StackOverflow</a></li>
    <li><a class="twitter" href="//twitter.com/tlatsas"><i class="icon-twitter"></i> Twitter</a></li>
    
  </ul>
</section>


  <section id="recent-posts" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Recent Posts</h1>
  <ul class="divided">
    
      <li class="post">
        <a href="/2013/11/03/reading-from-named-pipes-in-xmobar/">reading from named pipes in xmobar</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/28/using-git-rebase-to-remove-duplicate-cherry-picked-commits/">using git rebase to remove duplicate cherry-picked commits</a>
      </li>
    
      <li class="post">
        <a href="/2013/07/23/preview-sphinx-documentation/">preview sphinx documentation</a>
      </li>
    
      <li class="post">
        <a href="/2013/04/29/installing-Arch-Linux-ARM-in-Raspberry-Pi/">installing Arch Linux ARM in Raspberry Pi</a>
      </li>
    
      <li class="post">
        <a href="/2012/09/28/adjusting-HDD-spindown-with-systemd-service-files/">adjusting HDD spindown with systemd service files</a>
      </li>
    
  </ul>
</section>

<section id="github-repos" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">
    GitHub Repos
    
    <small class="pull-right">
      <a class="btn" href="//github.com/tlatsas" title="@tlatsas on GitHub" target="_blank">
        <i class="icon-external-link"></i>
      </a>
    </small>
    
  </h1>
  <ul id="gh_repos" class="divided">
    <li class="loading">
      <i class="icon-spinner icon-spin"></i>
    </li>
  </ul>
</section>



</div>

        </aside>
        
      </div>
    </div>
    
    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <p class="copyright">
  All content by Tasos Latsas and licenced under <a href="//creativecommons.org/licenses/by-nc-sa/3.0/ie/">Creative Commons</a>.<br>
  Code under <a href="//github.com/coogie/oscailte/blob/master/README.md">MIT Licence</a>.
</p>
    </div>
  </div>
</div>

    </footer>

    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
<script defer src="/javascripts/octopress.js"></script>




<script>
  var disqus_shortname = 'tlgh';
  
    
    // var disqus_developer = 1;
    var disqus_identifier = 'http://www.kodama.gr/2013/04/29/installing-Arch-Linux-ARM-in-Raspberry-Pi/';
    var disqus_url = 'http://www.kodama.gr/2013/04/29/installing-Arch-Linux-ARM-in-Raspberry-Pi/';
    var disqus_script = 'embed.js';
  
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>




<script>
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'tlatsas',
      count: 5,
      skip_forks: false,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>






  </body>
</html>